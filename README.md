# rxmd
ReaxFF MD code repository 

## Currently tested env
> source /usr/usc/intel/16.0/setup.sh

> source /usr/usc/openmpi/1.8.7/setup.sh.intel


## threaded non-bonding pair support 
this version requires OpenMP enabled as default. If you are going to use two Infiniband nodes in priya queue to run a 16 MPIrank rxmd job,

> qsub -I -d . -l nodes=2:ppn=16:priya_IB,walltime=2:00:00

> mpirun -x OMP_NUM_THREADS=2 --bind-to none -npernode 8 -np 16 ./rxmd

###sample output
```
[knomura@cetuslac1 rxmd]$ runjob --np 1024 -p 1 --block $COBALT_PARTNAME --verbose=INFO --envs=OMP_NUM_THREADS=64
              rxmd has started
----------------------------------------------------------------
         req/alloc # of procs:     1024  /     1024
         req proc arrengement:       32       32        1
                parameter set:Reactive MD-force field: nitramines (RDX/HMX/TATB/PETN)               
                time step[fs]:    2.50E-01
 MDMODE CURRENTSTEP NTIMESTPE:  1         0       200
  isQEq,QEq_tol,NMAXQEq,qstep:     1   1.0E-06   500     1
                Lex_fqs,Lex_k:   1.000   2.000
            treq,vsfact,sstep:     300.000   1.000     1000
                  fstep,pstep:   100    10
               NATOMS GNATOMS:                    8064                 8257536
                         LBOX:       0.031       0.031       1.000
                  Hmatrix [A]:        421.760          0.000          0.000
                  Hmatrix [A]:          0.000        370.240          0.000
                  Hmatrix [A]:          0.000          0.000        514.080
               lata,latb,latc:     421.760     370.240     514.080
          lalpha,lbeta,lgamma:      90.000      90.000      90.000
               density [g/cc]:    1.8061
         # of linkedlist cell:     4     3   162
            maxrc, lcsize [A]:     3.160        3.29      3.86      3.17
     MAXNEIGHBS, MAXNEIGHBS10:    50   900
            NMINCELL, NBUFFER:     3    80000
    FFPath, DataDir, ParmPath:      ffield          DAT      rxmd.in
          # of atoms per type:     1179648 - 1     2359296 - 2     2359296 - 3     2359296 - 4
----------------------------------------------------------------
nstep  TE  PE  KE: 1-Ebond 2-(Elnpr,Eover,Eunder) 3-(Eval,Epen,Ecoa) 4-(Etors,Econj) 5-Ehbond 6-(Evdw,EClmb,Echarge)
        0 -9.82425E+01 -9.82425E+01  0.00000E+00 -1.369E+02  1.287E+00 -1.362E+00  5.247E-01 -1.398E-03  3.821E+01     0.00    0.00    0.00  38  794.10
       10 -9.82429E+01 -9.82432E+01  2.34218E-04 -1.369E+02  1.290E+00 -1.364E+00  5.249E-01 -1.397E-03  3.821E+01     0.08    0.00    0.00   1  112.77
       20 -9.82431E+01 -9.82435E+01  4.80479E-04 -1.369E+02  1.287E+00 -1.366E+00  5.234E-01 -1.408E-03  3.821E+01     0.16    0.00    0.00   1   93.47
       30 -9.82430E+01 -9.82438E+01  7.79662E-04 -1.369E+02  1.283E+00 -1.365E+00  5.218E-01 -1.411E-03  3.821E+01     0.26    0.00    0.00  15   91.94
       40 -9.82431E+01 -9.82444E+01  1.30410E-03 -1.369E+02  1.295E+00 -1.365E+00  5.234E-01 -1.414E-03  3.821E+01     0.44    0.00    0.00   1   93.13
       50 -9.82431E+01 -9.82449E+01  1.79508E-03 -1.369E+02  1.298E+00 -1.365E+00  5.235E-01 -1.407E-03  3.822E+01     0.60    0.00    0.00  20   97.17
       60 -9.82430E+01 -9.82454E+01  2.36159E-03 -1.369E+02  1.291E+00 -1.366E+00  5.212E-01 -1.281E-03  3.823E+01     0.79    0.00    0.00   1   96.98
       70 -9.82431E+01 -9.82462E+01  3.14099E-03 -1.369E+02  1.292E+00 -1.368E+00  5.207E-01 -1.280E-03  3.822E+01     1.05    0.00    0.00   1   91.21
       80 -9.82432E+01 -9.82471E+01  3.94908E-03 -1.369E+02  1.293E+00 -1.368E+00  5.193E-01 -1.279E-03  3.821E+01     1.33    0.00    0.00   1   92.55
       90 -9.82431E+01 -9.82480E+01  4.83762E-03 -1.369E+02  1.294E+00 -1.365E+00  5.177E-01 -1.287E-03  3.822E+01     1.62    0.00    0.00  29  102.66
      100 -9.82433E+01 -9.82492E+01  5.92555E-03 -1.369E+02  1.299E+00 -1.365E+00  5.191E-01 -1.405E-03  3.823E+01     1.99    0.00    0.00  34   99.49
      110 -9.82432E+01 -9.82503E+01  7.05702E-03 -1.369E+02  1.293E+00 -1.366E+00  5.186E-01 -1.420E-03  3.822E+01     2.37    0.00    0.00  31  118.79
      120 -9.82430E+01 -9.82511E+01  8.13121E-03 -1.369E+02  1.283E+00 -1.365E+00  5.166E-01 -1.433E-03  3.820E+01     2.73    0.00    0.00  34  101.95
      130 -9.82430E+01 -9.82525E+01  9.43378E-03 -1.369E+02  1.291E+00 -1.366E+00  5.164E-01 -1.454E-03  3.820E+01     3.17    0.00    0.00  36  104.54
      140 -9.82430E+01 -9.82537E+01  1.07500E-02 -1.369E+02  1.296E+00 -1.365E+00  5.161E-01 -1.467E-03  3.822E+01     3.61    0.00    0.00  36  100.93
      150 -9.82429E+01 -9.82550E+01  1.20850E-02 -1.369E+02  1.291E+00 -1.365E+00  5.152E-01 -1.469E-03  3.822E+01     4.06    0.00    0.00  28  101.29
      160 -9.82431E+01 -9.82567E+01  1.36835E-02 -1.369E+02  1.290E+00 -1.369E+00  5.166E-01 -1.483E-03  3.821E+01     4.59    0.00    0.00  24  103.64
      170 -9.82431E+01 -9.82584E+01  1.52851E-02 -1.369E+02  1.288E+00 -1.372E+00  5.157E-01 -1.483E-03  3.820E+01     5.13    0.00    0.00  31  100.96
      180 -9.82430E+01 -9.82599E+01  1.68775E-02 -1.369E+02  1.288E+00 -1.373E+00  5.131E-01 -1.480E-03  3.822E+01     5.66    0.00    0.00  35   99.08
      190 -9.82432E+01 -9.82619E+01  1.86267E-02 -1.369E+02  1.300E+00 -1.376E+00  5.136E-01 -1.463E-03  3.823E+01     6.25    0.00    0.00  16  102.35
Max MAXNEIGHBS, Max MAXNEIGHBS10, Max NBUFFER:           12         447        8119
               QEq:     516.8300       268.1200
    qeq_initialize:     100.4300       100.1400
      qeq_finalize:       0.6900         0.4800
           get_hsh:      14.3900        13.7500
      get_gradient:     260.1600        11.5700
        LINKEDLIST:       3.2300         2.6100
         COPYATOMS:     753.4800       143.8100
      NEIGHBORLIST:      66.7300        66.4500
     GetNBPairList:      64.2600        63.9400
            BOCALC:     110.8800       110.2700
            ENbond:    1100.6800       494.3100
             Ebond:       5.6300         5.1300
             Elnpr:     168.3700       167.3300
               Ehb:      65.5500        63.2000
               E3b:      22.4900        20.8300
               E4b:      88.3000        85.4400
  ForceBondedTerms:       4.2700         4.0400
   COPYATOMS(MOVE):       0.0000         0.0000
          WriteBND:      20.4100        20.3400
          WritePDB:      15.3200        15.2600
           ReadBIN:       2.0400         2.0000
          WriteBIN:      24.7200        23.2600
       total (sec):    2004.1000      2004.0600
    rxmd successfully finished


```

